

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Common mistakes &mdash; GHDL-cosim latest documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://media.readthedocs.org/css/sphinx_rtd_theme.css" type="text/css" />
  <link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Introduction" href="../vpi/index.html" />
    <link rel="prev" title="Other co-simulation projects" href="examples/other.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> GHDL-cosim
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">VHPIDIRECT</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="declarations.html">Type declarations</a></li>
<li class="toctree-l1"><a class="reference internal" href="wrapping.html">Wrapping a simulation (ghdl_main)</a></li>
<li class="toctree-l1"><a class="reference internal" href="linking.html">Linking object files</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamic.html">Dynamic loading</a></li>
<li class="toctree-l1"><a class="reference internal" href="grt.html">Using GRT</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/index.html">Examples</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Common mistakes</a></li>
</ul>
<p class="caption"><span class="caption-text">VPI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vpi/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vpi/examples/index.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">VPHI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vhpi/index.html">Introduction</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GHDL-cosim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Common mistakes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/vhpidirect/mistakes.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="common-mistakes">
<span id="cosim-vhpidirect-mistakes"></span><h1>Common mistakes<a class="headerlink" href="#common-mistakes" title="Permalink to this headline">Â¶</a></h1>
<ul class="simple">
<li><p>Although function overloading is supported in VHDL, it is not possible in C. Hence, it should be avoided to declare
multiple procedures/functions which map to the same foreign subprogram. For the compiler, there is only one definition
of the imported function. So, if different prototypes/profiles are declared, weird things may happen. See <a class="reference external" href="https://github.com/ghdl/ghdl/issues/639">ghdl#639</a>.</p></li>
<li><p>If a procedure/function is decorated with the <code class="docutils literal notranslate"><span class="pre">foreign</span></code> attribute, apart from a matching body in VHDL, the foreign
subprogram <strong>must</strong> be defined (linked) for elaboration to succeed. This is required even when it is not used in the
design. In context where conditional inclusion of VHPIDIRECT features is required, it is suggested to provide
alternative (dummy) sources for either VHDL packages or C sources (see <a class="reference external" href="https://github.com/ghdl/ghdl/issues/793">ghdl#793</a>).</p></li>
<li><p>There are some corner cases when using large variables/signals. When you try to allocate a single object which is too
large, GHDL will complain. That can be fixed with <a class="reference external" href="https://ghdl.readthedocs.io/en/latest/using/Simulation.html#cmdoption-ghdl-max-stack-alloc" title="(in GHDL v1.0-dev)"><code class="xref std std-option docutils literal notranslate"><span class="pre">--max-stack-alloc</span></code></a>. However, when you allocate multiple
objects which are smaller than the limit, but the last one overflows, GHDL will not complain, it will crash instead.
In this case, <code class="docutils literal notranslate"><span class="pre">ulimit</span></code> needs to be modified/increased. To remove the limit, set <code class="docutils literal notranslate"><span class="pre">ulimit</span> <span class="pre">-s</span> <span class="pre">unlimited</span></code>.
See <a class="reference external" href="https://github.com/ghdl/ghdl/issues/1112">ghdl#1112</a>.</p>
<ul>
<li><p>In Python (say, when using VUnit or cocotb), the stack size can be increased by using the <a class="reference external" href="https://docs.python.org/3/library/resource.html#resource.setrlimit">resource module</a>.
For example <code class="docutils literal notranslate"><span class="pre">resource.setrlimit(resource.RLIMIT_STACK,</span> <span class="pre">(resource.RLIM_INFINITY,</span> <span class="pre">resource.RLIM_INFINITY))</span></code>.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>The size of objects is supposed to be 4GB. However, users finding the limit might get different constraints, depending
on the backend. See <a class="reference external" href="https://github.com/ghdl/ghdl/issues/822">ghdl#822</a>.</p></li>
</ul>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../vpi/index.html" class="btn btn-neutral float-right" title="Introduction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="examples/other.html" class="btn btn-neutral float-left" title="Other co-simulation projects" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Tristan Gingold and contributors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>